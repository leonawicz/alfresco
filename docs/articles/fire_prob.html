<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fire point probability • alfresco</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46129458-3', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">alfresco</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/alfresco.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fire_prob.html">Fire point probability</a>
    </li>
    <li>
      <a href="../articles/jfsp_extract.html">JFSP data extraction</a>
    </li>
    <li>
      <a href="../articles/jfsp_hist_fmo_tx.html">JFSP fire management treatments</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-globe fa-lg"></span>
     
    SNAPverse
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://leonawicz.github.io/sv.html">Home of the verse</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Sector packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapverse">snapverse</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snaplite">snaplite</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdata">snapdata</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapwebs">snapwebs</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Functions packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapfuns">snapfuns</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snaplocs">snaplocs</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapprep">snapprep</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/alfresco">alfresco</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Data packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapclim">snapclim</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapfire">snapfire</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snappoly">snappoly</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapgrid">snapmaps</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdist">snapdist</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Apps &amp; docs packages</li>
    <li>
      <a href="https://leonawicz.github.io/snapapps">snapapps</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdash">snapdash</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapflex">snapflex</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapdocs">snapdocs</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Satellite packages</li>
    <li>
      <a href="https://leonawicz.github.io/rvtable">rvtable</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/apputils">apputils</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/maputils">maputils</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snaputils">snaputils</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapmeta">snapmeta</a>
    </li>
    <li>
      <a href="https://leonawicz.github.io/snapsite">snapsite</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/leonawicz/alfresco">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Fire point probability</h1>
            
          </div>

    
    
<div class="contents">
<p>This vignette provides example code for estimating fire probability from ALFRESCO outputs at point locations as well as an assessment of the estimates. It is broken down into three main sections:</p>
<ul>
<li>Estimating fire point probabilities.</li>
<li>A statistical modeling framework for point probabilities.</li>
<li>Estimate calibration and model validation.</li>
</ul>
<div id="estimating-point-probabilities" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-point-probabilities" class="anchor"></a>Estimating point probabilities</h2>
<p>There is an inherent challenge in estimating various fire statistics and spatial point locations with ALFRESCO. While it generates spatially explicit wildfire simulations, it is not meaningful to talk about, say, the likelihood of fire over some future projected time period at a single point in space. Statements based on such spatial precision are generally not robust or defensible.</p>
<p>However, there are ways to approximate point-specific fire projections that are relatively robust and stable. A simple approach is to place a buffer of some radius <code>r</code> around a point location and make statements about projected fire in this area. There is a trade off involved. The goal is to make the area around a point large enough that nearby fire events intersect it and estimates are not highly volatile, while also making sure it area is still small enough to justifiably represent point data. This is a challenging needle to thread, with no clear, single answer regarding area size. A more rigorous approach involves selecting a larger area around a point location, but applying some function or model using inverse distance weighting so that fire at greater distances from the point is given less weight.</p>
<p>The latter approach is used here. While ALFRESCO provides spatially explicit maps of simulated fire scar perimeters, this in and of itself does not directly translate into any estimate of the likelihood of fire at a specific point. The closest one can get with this raw simulation output is to make a binary statement that says a location will or will not burn. This does not take into account, for example, the difference in likelihood of fire at one point where a large fire is nearby (even if not intersecting the point itself) vs. at another point where there is no fire within some large distance of the point. The approach used here allows for a smoother estimation of fire probability at a point by accounting for how close and how large nearby fires are. When ALFRESCO simulates a burn in some area on a map, it is meaningful and informative to account for proximity rather than to treat projected burns as having some kind of realistic exactness in space.</p>
<div id="jfsp-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#jfsp-outputs" class="anchor"></a>JFSP outputs</h3>
<p>Using the JFSP project simulation outputs, take a random sample of 30 points and estimate fire probabilities. The code below uses a random sample (<code>n = 100</code>) among all climate models, emissions scenarios, projected years 2014 - 2099, simulation replicates, and fire management treatment levels. This yields 5,000 observations.</p>
<div id="sample-communities" class="section level4">
<h4 class="hasAnchor">
<a href="#sample-communities" class="anchor"></a>Sample communities</h4>
<p>First sample 50 point locations from within the JFSP flammability domain using the <code>snapgrid</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(snapgrid)
<span class="kw">library</span>(raster)
<span class="kw">set.seed</span>(<span class="dv">976</span>)
places &lt;-<span class="st"> </span><span class="kw">sample</span>((<span class="dv">1</span>:<span class="kw">ncell</span>(swflam))[!<span class="kw">is.na</span>(swflam[])], <span class="dv">30</span>)</code></pre></div>
</div>
<div id="sample-fire-scar-data" class="section level4">
<h4 class="hasAnchor">
<a href="#sample-fire-scar-data" class="anchor"></a>Sample fire scar data</h4>
<p>Next sample 100 simulated fire scar perimeters maps from JFSP ALFRESCO projected outputs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(alfresco)
base_path &lt;-<span class="st"> "/big_scratch/shiny/Runs_Statewide/mfleonawicz@alaska.edu"</span>
paths &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">list.files</span>(base_path, <span class="dt">pattern =</span> <span class="st">"^fmo.*.rcp"</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>), 
    <span class="st">"Maps"</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
years &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">2014</span>:<span class="dv">2099</span>, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
reps &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">31</span>, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
runs &lt;-<span class="st"> </span><span class="kw">sample</span>(paths, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)  <span class="co"># random run (rcp, model, fmo)</span>
sample_files &lt;-<span class="st"> </span>purrr::<span class="kw">map</span>(<span class="kw">c</span>(<span class="dt">scar =</span> <span class="st">"/FireScar"</span>, <span class="dt">veg =</span> <span class="st">"/Veg"</span>), ~<span class="kw">paste0</span>(runs, 
    .x, <span class="st">"_"</span>, reps, <span class="st">"_"</span>, years, <span class="st">".tif"</span>))</code></pre></div>
</div>
</div>
<div id="fire-probability-results" class="section level3">
<h3 class="hasAnchor">
<a href="#fire-probability-results" class="anchor"></a>Fire probability results</h3>
<p>Here are results of the probability estimation…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xy &lt;-<span class="st"> </span><span class="kw">select</span>(places, lon, lat)
id &lt;-<span class="st"> </span>places$loc
p &lt;-<span class="st"> </span>purrr::<span class="kw">map</span>(<span class="dv">1</span>:n, ~<span class="kw"><a href="../reference/point_probs.html">point_probs</a></span>(<span class="dt">r =</span> sample_files$scar[.x], xy, id, <span class="dt">veg =</span> sample_files$veg[.x])) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">bind_rows</span>()</code></pre></div>
</div>
</div>
<div id="statistical-model" class="section level2">
<h2 class="hasAnchor">
<a href="#statistical-model" class="anchor"></a>Statistical model</h2>
<p>After exploring the point probabilities based on inverse distance weighting, perform a guided exploratory model selection using other covariates to model the linkage with fire probability.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gbm)
gbm1 &lt;-<span class="st"> </span><span class="kw">gbm</span>(prob ~<span class="st"> </span>., <span class="dt">data =</span> <span class="kw">select</span>(p, <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>:<span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">14</span>:<span class="dv">16</span>)))</code></pre></div>
</div>
<div id="points-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#points-of-interest" class="anchor"></a>Points of interest</h2>
<p>Given the findings of the statistical models, perform a sensitivity analysis based on a simple 2-factor experimental design setup. Then build a final statistical model, calibrate the probability estimation, and apply it to some points of interest.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(snaplocs)
places &lt;-<span class="st"> </span><span class="kw">get_coords</span>(<span class="kw">c</span>(<span class="st">"Fairbanks"</span>, <span class="st">"Galena"</span>, <span class="st">"Fort Yukon"</span>), <span class="dt">keep_cols =</span> <span class="ot">TRUE</span>) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">slice</span>(<span class="dv">1</span>:<span class="dv">3</span>)
places
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;          loc region      lon     lat</span>
<span class="co">#&gt;        &lt;chr&gt; &lt;fctr&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1  Fairbanks Alaska -147.716 64.8378</span>
<span class="co">#&gt; 2 Fort Yukon Alaska -145.274 66.5647</span>
<span class="co">#&gt; 3     Galena Alaska -156.927 64.7333</span></code></pre></div>
<p>Document under development…</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#estimating-point-probabilities">Estimating point probabilities</a></li>
      <li><a href="#statistical-model">Statistical model</a></li>
      <li><a href="#points-of-interest">Points of interest</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://leonawicz.github.io/">Matthew Leonawicz</a>, <a href="http://snap.uaf.edu/"><img src="https://raw.githubusercontent.com/leonawicz/leonawicz.github.io/master/assets/img/snap_symbol.svg?sanitize=true" height="24">  Scenarios Network for Alaska and Arctic Planning</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
